(this["webpackJsonpcrusade-log"]=this["webpackJsonpcrusade-log"]||[]).push([[0],{110:function(e,t,a){e.exports=a.p+"static/media/EditIcon.aa0b5ae2.svg"},111:function(e,t,a){e.exports=a.p+"static/media/CopyIcon.49972eac.svg"},114:function(e,t,a){e.exports=a.p+"static/media/ThreeDotsVerticalIcon.f1d479ac.svg"},117:function(e,t,a){e.exports=a(295)},122:function(e,t,a){},123:function(e,t,a){},295:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(108),c=a.n(l),o=(a(122),a(123),a(6)),u=a(9),i=a(7);function m(e){var t,a=e.battleParticipation+3*e.markedForGreatness+e.agendaXp+Math.floor(e.kills/3)-(null!==(t=e.experienceLoss)&&void 0!==t?t:0);return a>0?a:0}function s(e){var t,a,n,r;return(e.warlordTrait?1:0)+(e.relic?1:0)+(e.battleHonours&&e.battleHonours.length>0?null===(t=e.battleHonours)||void 0===t||null===(a=t.map((function(e){return e.crusadePoints})))||void 0===a?void 0:a.reduce((function(e,t){return(null!==e&&void 0!==e?e:0)+t})):0)+(0-(null!==(n=null===(r=e.battleScars)||void 0===r?void 0:r.length)&&void 0!==n?n:0))}var d=a(298),f=a(109),E=a(302);var v=function(e){var t=[];return e.nameEffects.forEach((function(e,a){t.push(r.a.createElement(r.a.Fragment,{key:a},r.a.createElement(E.a.Subtitle,{className:"mt-1 ml-2"},e.name),r.a.createElement(E.a.Text,{className:"ml-2"},e.effect)))})),r.a.createElement(d.a,{className:"mb-3"},r.a.createElement(f.a,null,r.a.createElement(E.a,null,r.a.createElement(E.a.Header,{className:"py-1"},e.header),t)))};var b,p=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),l=a[0],c=a[1],u=m(e.unit),i=null;e.unit.warlordTrait&&(i=r.a.createElement(v,{header:"Warlord Trait",nameEffects:[e.unit.warlordTrait]}));var s=null;e.unit.relic&&(s=r.a.createElement(v,{header:"Relic",nameEffects:[e.unit.relic]}));var E=void 0;if(e.unit.battleHonours&&e.unit.battleHonours.length>0){var b=[];e.unit.battleHonours.forEach((function(e){e.battleTrait&&b.push(e.battleTrait)})),E=r.a.createElement(v,{header:"Battle Honours",nameEffects:b})}var p=void 0;if(e.unit.battleScars&&e.unit.battleScars.length>0){var y=[];e.unit.battleScars.forEach((function(e){y.push(e)})),p=r.a.createElement(v,{header:"Battle Scars",nameEffects:y})}var h=null;l&&(h=r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Battle Participation"),r.a.createElement(f.a,null,e.unit.battleParticipation)),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Marked For Greatness"),r.a.createElement(f.a,null,e.unit.markedForGreatness)),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Agenda"),r.a.createElement(f.a,null,e.unit.agendaXp)),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Kills"),r.a.createElement(f.a,null,e.unit.kills))));var g=null;return e.unit.otherTraits&&e.unit.otherTraits.length>0&&(g=e.unit.otherTraits.map((function(e,t){return r.a.createElement(v,{key:t,header:e.name,nameEffects:e.nameEffects})}))),r.a.createElement(r.a.Fragment,null,i,s,E,p,g,r.a.createElement(d.a,{className:"mb-2",onClick:function(){c(!l)}},r.a.createElement(f.a,null,"Total Experience"),r.a.createElement(f.a,null,u)),h)};!function(e){e.BattleReady="Battle-Ready",e.Blooded="Blooded",e.Custom="Custom Battle Trait",e.BattleHardened="Battle-Hardened",e.Heroic="Heroic",e.Legendary="Legendary"}(b||(b={}));var y=a(301);var h=function(e){var t,a,n=void 0;return e.formName&&(n=r.a.createElement(d.a,null,r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,e.formName)))),r.a.createElement(y.a.Group,{as:d.a,className:"mb-2",controlId:"form".concat(e.formName)},r.a.createElement(f.a,null,n,r.a.createElement(d.a,null,r.a.createElement(f.a,{className:"pr-1"},r.a.createElement(y.a.Control,{type:"textbox",onChange:e.onNameChange,value:null===(t=e.nameEffect)||void 0===t?void 0:t.name,placeholder:"Name"})),r.a.createElement(f.a,{className:"pl-1"},r.a.createElement(y.a.Control,{type:"textbox",onChange:e.onEffectChange,value:null===(a=e.nameEffect)||void 0===a?void 0:a.effect,placeholder:"Effect"})))))},g=a(305);var C=function(e){return r.a.createElement(ee.Consumer,null,(function(t){return r.a.createElement(g.a,{variant:e.primary?"primary":"outline-primary",onClick:e.onClick,type:e.submit?"submit":"button",block:!0,style:{borderColor:e.color||t,color:e.primary?"white":e.color||t,backgroundColor:e.primary?e.color||t:"white"},size:e.small?void 0:"lg"},e.name)}))};var k=function(e){function t(t,a){e.editUnit((function(e){var n=Object(i.a)({},e.battleScars[a]);t(n),e.battleScars.splice(a,1,n)}))}var a=[];return e.unit.battleScars&&e.unit.battleScars.length>0&&e.unit.battleScars.forEach((function(e,n){a.push(r.a.createElement(h,{key:n,onEffectChange:function(e){return t((function(t){return t.effect=e.target.value}),n)},onNameChange:function(e){return t((function(t){return t.name=e.target.value}),n)},nameEffect:e}))})),r.a.createElement(y.a.Group,{as:d.a,className:"mb-2",controlId:"formWarlordTrait"},r.a.createElement(f.a,null,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,"Battle Scars")),r.a.createElement(f.a,null,r.a.createElement(C,{small:!0,onClick:function(t){t.preventDefault(),e.editUnit((function(e){var t=e.battleScars;t||(t=[]),e.battleScars.push({})}))},name:"Add"}))),a))};var N=function(e){return r.a.createElement(y.a.Group,{as:d.a,className:"mb-2",controlId:"form".concat(e.formName)},r.a.createElement(f.a,{xs:e.resetFirstColSpan?void 0:4},r.a.createElement(y.a.Label,null,e.formName)),r.a.createElement(f.a,null,r.a.createElement(y.a.Control,{type:e.inputType,onChange:e.onChange,value:e.value,placeholder:e.placeHolder||e.formName})))};var O=function(e){var t=e.firstColumn;return e.label&&(t=r.a.createElement(y.a.Label,null,e.firstColumn)),r.a.createElement(d.a,{className:"mb-2",onClick:e.onClick},r.a.createElement(f.a,null,t),r.a.createElement(f.a,null,e.secondColumn))};var j=function(e){var t=m(e.unit)+1,a=Object(n.useState)(t-1),l=Object(o.a)(a,1)[0],c=e.unit.battleHonours.map((function(t,a){var n,c;return t.rank===b.Blooded&&l<6||t.rank===b.BattleHardened&&l<16||t.rank===b.Heroic&&l<31||t.rank===b.Legendary&&l<51?r.a.createElement(h,{nameEffect:t.battleTrait,onEffectChange:function(a){var n=Object(i.a)({},e.unit),r=n.battleHonours.find((function(e){return e.rank===t.rank}));(null===r||void 0===r?void 0:r.battleTrait)||(r.battleTrait={}),r.battleTrait.effect=a.target.value,e.updateUnit(n)},onNameChange:function(a){var n=Object(i.a)({},e.unit),r=n.battleHonours.find((function(e){return e.rank===t.rank}));(null===r||void 0===r?void 0:r.battleTrait)||(r.battleTrait={}),r.battleTrait.name=a.target.value,e.updateUnit(n)},formName:t.rank}):r.a.createElement(O,{key:a,firstColumn:(null===(n=t.battleTrait)||void 0===n?void 0:n.name)||"",label:!0,secondColumn:(null===(c=t.battleTrait)||void 0===c?void 0:c.effect)||""})}));return r.a.createElement(ee.Consumer,null,(function(a){return r.a.createElement(d.a,null,r.a.createElement(f.a,null,r.a.createElement("h3",{className:"mt-3",style:{borderTop:"1px solid ".concat(a)}},e.unit.name),r.a.createElement(O,{firstColumn:"Battle Participation",label:!0,secondColumn:"".concat(e.unit.battleParticipation," + 1")}),r.a.createElement(N,{resetFirstColSpan:!0,inputType:"number",onChange:function(t){var a=Object(i.a)({},e.unit);a.markedForGreatness=Number.parseInt(t.target.value),e.updateUnit(a)},formName:"Greatness",value:e.unit.markedForGreatness}),r.a.createElement(N,{resetFirstColSpan:!0,inputType:"number",onChange:function(t){var a=Object(i.a)({},e.unit);a.agendaXp=Number.parseInt(t.target.value),e.updateUnit(a)},formName:"Agenda",value:e.unit.agendaXp}),r.a.createElement(N,{resetFirstColSpan:!0,inputType:"number",onChange:function(t){var a=Object(i.a)({},e.unit);a.kills=Number.parseInt(t.target.value),e.updateUnit(a)},formName:"Kills",value:e.unit.kills}),r.a.createElement(O,{firstColumn:"Total Experience",label:!0,secondColumn:t}),c,r.a.createElement(k,{unit:e.unit,editUnit:function(t){var a=Object(i.a)(Object(i.a)({},e.unit),{},{battleScars:Object(u.a)(e.unit.battleScars||[])});t(a),e.updateUnit(a)}})))}))};var T=function(e){return r.a.createElement(d.a,{className:"mb-2"},e.tertiaryButtonOnClick&&e.tertiaryButtonName&&r.a.createElement(f.a,null,r.a.createElement(C,{color:e.color,name:e.tertiaryButtonName,onClick:e.tertiaryButtonOnClick})),r.a.createElement(f.a,null,r.a.createElement(C,{color:e.color,name:e.secondaryButtonName,onClick:e.secondaryButtonOnClick})),r.a.createElement(f.a,null,r.a.createElement(C,{color:e.color,name:e.primaryButtonName,onClick:e.primaryButtonOnClick,primary:!0,submit:!0})))};var A=function(e){var t=Object(n.useState)(e.crusadeArmy.units),a=Object(o.a)(t,2),l=a[0],c=a[1],s=Object(n.useState)(e.crusadeArmy.requisitionPoints?e.crusadeArmy.requisitionPoints+1:1),f=Object(o.a)(s,2),E=f[0],v=f[1],p=[];return l.forEach((function(t,a){var n;(null===(n=e.crusadeArmy.battleRosterUnitIds)||void 0===n?void 0:n.includes(t.id))&&p.push(r.a.createElement(j,{unit:t,key:t.id,updateUnit:function(e){return function(e,t){var a=Object(u.a)(l),n=m(e)+1;e.battleHonours.findIndex((function(e){return e.rank===b.Blooded}))<0&&n>=6?e.battleHonours.push({crusadePoints:e.powerLevel>=11?2:1,battleTrait:{effect:""},rank:b.Blooded}):e.battleHonours.findIndex((function(e){return e.rank===b.BattleHardened}))<0&&n>=16?e.battleHonours.push({crusadePoints:e.powerLevel>=11?2:1,battleTrait:{effect:""},rank:b.BattleHardened}):e.battleHonours.findIndex((function(e){return e.rank===b.Heroic}))<0&&n>=31?e.battleHonours.push({crusadePoints:e.powerLevel>=11?2:1,battleTrait:{effect:""},rank:b.Heroic}):e.battleHonours.findIndex((function(e){return e.rank===b.Legendary}))<0&&n>=51&&e.battleHonours.push({crusadePoints:e.powerLevel>=11?2:1,battleTrait:{effect:""},rank:b.Legendary}),a.splice(t,1,e),c(a)}(e,a)}}))})),r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,"Fill Unit Stats")),r.a.createElement(y.a,null,r.a.createElement(N,{resetFirstColSpan:!0,formName:"RP",inputType:"number",onChange:function(e){return v(Number.parseInt(e.target.value))},value:E}),p,r.a.createElement(T,{primaryButtonName:"Save",primaryButtonOnClick:function(){var t=Object(i.a)({},e.crusadeArmy);t.units=l,l.forEach((function(e){return e.battleParticipation++})),t.battleRosterUnitIds=void 0,t.requisitionPoints=E,e.updateArmy(t)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack})))},w=a(110),B=a.n(w);var S=function(e){var t,a=void 0;e.onEdit&&(a=r.a.createElement("img",{className:"icon",src:B.a,alt:"Edit Links",onClick:e.onEdit}));var n=null===(t=e.subHeaderInfo)||void 0===t?void 0:t.map((function(e,t){return r.a.createElement(d.a,{key:t},r.a.createElement("b",null,e.value+" "),e.name)}));return r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement(f.a,{as:"h2",className:"p-0",xs:9},e.headerText,a),r.a.createElement(f.a,{xs:2,className:"pl-0"},n))};var P=function(e){var t=Object(n.useState)(),a=Object(o.a)(t,2),l=a[0],c=a[1],u=[];if(e.crusadeArmy.units.forEach((function(t){e.crusadeArmy.battleRosterUnitIds&&e.crusadeArmy.battleRosterUnitIds.includes(t.id)&&(u.push(r.a.createElement(ee.Consumer,{key:t.id+" Header"},(function(e){return r.a.createElement("h3",{className:"mt-3",style:{borderTop:"1px solid ".concat(e)}},t.name)}))),u.push(r.a.createElement(p,{unit:t,key:t.id})))})),l)return r.a.createElement(A,{crusadeArmy:e.crusadeArmy,goBack:function(){return c(!1)},updateArmy:e.updateArmy});var i=0,m=0;return e.crusadeArmy.units.forEach((function(t){var a;(null===(a=e.crusadeArmy.battleRosterUnitIds)||void 0===a?void 0:a.includes(t.id))&&(i+=t.powerLevel,m+=s(t))})),r.a.createElement(r.a.Fragment,null,r.a.createElement(S,{subHeaderInfo:[{name:"PL",value:i},{name:"CP",value:m},{name:"RP",value:e.crusadeArmy.requisitionPoints}],headerText:"Battle Roster"}),e.crusadeArmy.detachmentTrait&&r.a.createElement(v,{nameEffects:[e.crusadeArmy.detachmentTrait],header:"Detachment Trait"}),u,r.a.createElement(T,{primaryButtonName:"Continue",primaryButtonOnClick:function(){return c(!0)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))};var x=function(e){var t=Object(n.useState)([]),a=Object(o.a)(t,2),l=a[0],c=a[1],m=e.crusadeArmy.units.map((function(e){return r.a.createElement(ee.Consumer,null,(function(t){return r.a.createElement(y.a.Group,{onClick:function(){return function(e){var t=[];t=l.includes(e)?l.filter((function(t){return t!==e})):[].concat(Object(u.a)(l),[e]),c(t)}(e.id)},className:"mb-1"},r.a.createElement(y.a.Check,{type:"checkbox",className:"custom-control",color:t},r.a.createElement(y.a.Check.Input,{className:"custom-control-input mr-1",color:t,checked:l.includes(e.id),style:{position:"relative"}}),r.a.createElement(y.a.Check.Label,{className:"custom-control-label",children:"".concat(e.name," ").concat(e.powerLevel,"PL"),style:{fontWeight:"unset"}})))}))})),E=0,v=0;return e.crusadeArmy.units.forEach((function(e){l.includes(e.id)&&(E+=e.powerLevel,v+=s(e))})),e.crusadeArmy.battleRosterUnitIds?r.a.createElement(P,{crusadeArmy:e.crusadeArmy,goBack:function(){var t=Object(i.a)({},e.crusadeArmy);t.battleRosterUnitIds=void 0,e.updateArmy(t)},updateArmy:e.updateArmy}):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,"Select Battle Roster")),r.a.createElement(O,{firstColumn:"Selected Power Level",secondColumn:E}),r.a.createElement(O,{firstColumn:"Selected Crusade Points",secondColumn:v}),r.a.createElement(y.a,null,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(C,{small:!0,name:"Select All",onClick:function(){var t=e.crusadeArmy.units.map((function(e){return e.id}));c(t)}}))),m),r.a.createElement(T,{primaryButtonName:"Continue",primaryButtonOnClick:function(){var t=Object(i.a)({},e.crusadeArmy);t.battleRosterUnitIds=l,e.updateArmy(t)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))},L=a(47),H=a.n(L);var I=function(e){var t=Object(n.useState)(""===e.unit.name),a=Object(o.a)(t,1)[0],l=Object(n.useState)(e.unit),c=Object(o.a)(l,2),s=c[0],E=c[1],v=Object(n.useState)(!1),p=Object(o.a)(v,2),g=p[0],j=p[1];function A(t){t.preventDefault(),t.stopPropagation();var a=s;a.otherTraits&&a.otherTraits.length>0&&(a.otherTraits=a.otherTraits.filter((function(e){return""!==e.name}))),e.saveUnit(a)}function w(e){var t=Object(i.a)(Object(i.a)({},s),{},{battleHonours:Object(u.a)(s.battleHonours),battleScars:Object(u.a)(s.battleScars||[])});e(t);var a=m(t);t.battleHonours.findIndex((function(e){return e.rank===b.Blooded}))<0&&a>=6?t.battleHonours.push({crusadePoints:t.powerLevel>=11?2:1,battleTrait:{effect:""},rank:b.Blooded}):t.battleHonours.findIndex((function(e){return e.rank===b.BattleHardened}))<0&&a>=16?t.battleHonours.push({crusadePoints:t.powerLevel>=11?2:1,battleTrait:{effect:""},rank:b.BattleHardened}):t.battleHonours.findIndex((function(e){return e.rank===b.Heroic}))<0&&a>=31?t.battleHonours.push({crusadePoints:t.powerLevel>=11?2:1,battleTrait:{effect:""},rank:b.Heroic}):t.battleHonours.findIndex((function(e){return e.rank===b.Legendary}))<0&&a>=51&&t.battleHonours.push({crusadePoints:t.powerLevel>=11?2:1,battleTrait:{effect:""},rank:b.Legendary}),E(t)}var B=m(s),S=0,P=s.battleHonours.map((function(e,t){return S+=e.crusadePoints,r.a.createElement(h,{key:t,formName:e.rank,onNameChange:function(t){w((function(a){var n=a.battleHonours.find((function(t){return t.rank===e.rank}));(null===n||void 0===n?void 0:n.battleTrait)||(n.battleTrait={}),n.battleTrait.name=t.target.value}))},onEffectChange:function(t){w((function(a){var n=a.battleHonours.find((function(t){return t.rank===e.rank}));(null===n||void 0===n?void 0:n.battleTrait)||(n.battleTrait={}),n.battleTrait.effect=t.target.value}))},nameEffect:e.battleTrait})})),x=g&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{formName:"Participation",inputType:"number",onChange:function(e){return w((function(t){return t.battleParticipation=Number.parseInt(e.target.value)}))},value:s.battleParticipation}),r.a.createElement(N,{formName:"Greatness",inputType:"number",onChange:function(e){return w((function(t){return t.markedForGreatness=Number.parseInt(e.target.value)}))},value:s.markedForGreatness}),r.a.createElement(N,{formName:"Agenda",inputType:"number",onChange:function(e){return w((function(t){return t.agendaXp=Number.parseInt(e.target.value)}))},value:s.agendaXp}),r.a.createElement(N,{formName:"Kills",inputType:"number",onChange:function(e){return w((function(t){return t.kills=Number.parseInt(e.target.value)}))},value:s.kills}),r.a.createElement(N,{formName:"Loss",inputType:"number",onChange:function(e){return w((function(t){return t.experienceLoss=Number.parseInt(e.target.value)}))},value:s.experienceLoss}));function L(e,t,a){w((function(n){if(n.otherTraits){var r=n.otherTraits[e].nameEffects[t];a(r)}}))}var I=null;return s.otherTraits&&s.otherTraits.length>0&&(I=s.otherTraits.map((function(e,t){var a=null;return e.nameEffects&&e.nameEffects.length>0&&(a=e.nameEffects.map((function(e,a){return r.a.createElement(h,{key:a,nameEffect:e,onEffectChange:function(e){return L(t,a,(function(t){return t.effect=e.target.value}))},onNameChange:function(e){return L(t,a,(function(t){return t.name=e.target.value}))}})}))),r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Control,{type:"textbox",onChange:function(e){return function(e,t){w((function(a){a.otherTraits&&(a.otherTraits[e].name=t)}))}(t,e.target.value)},value:e.name,placeholder:"Ability Name"})),r.a.createElement(f.a,null,r.a.createElement(C,{small:!0,name:"Add Effect",onClick:function(){return function(e){w((function(t){t.otherTraits&&t.otherTraits[e].nameEffects.push({})}))}(t)}}))),a)}))),r.a.createElement(y.a,{onSubmit:A,id:"edit-unit"},r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,a?"Adding Unit ":"Editting Unit ",r.a.createElement("img",{className:"icon",src:H.a,alt:"Edit Links",onClick:function(){window.confirm("Are you sure you wish to delete this unit?")&&e.deleteUnit(e.unit)}}))),r.a.createElement(N,{formName:"Name",inputType:"textbox",onChange:function(e){return w((function(t){return t.name=e.target.value}))},value:s.name}),r.a.createElement(N,{formName:"Power Level",inputType:"number",onChange:function(e){return w((function(t){return t.powerLevel=Number.parseInt(e.target.value)}))},value:s.powerLevel}),r.a.createElement(O,{label:!0,firstColumn:"Total Experience",secondColumn:B,onClick:function(){return j(!g)}}),x,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,"Traits and Honours")),r.a.createElement(f.a,null,r.a.createElement(C,{small:!0,name:"Add",onClick:function(){w((function(e){return e.battleHonours.push({rank:b.Custom,battleTrait:{},crusadePoints:e.powerLevel>=11?2:1})}))}}))),P,r.a.createElement(k,{unit:s,editUnit:w}),s.warlordTrait&&r.a.createElement(h,{formName:"Warlord Trait",onNameChange:function(e){return w((function(t){t.warlordTrait||(t.warlordTrait={}),t.warlordTrait.name=e.target.value}))},onEffectChange:function(e){return w((function(t){t.warlordTrait||(t.warlordTrait={}),t.warlordTrait.effect=e.target.value}))},nameEffect:s.warlordTrait}),r.a.createElement(O,{label:!0,firstColumn:"Crusade Points",secondColumn:S}),r.a.createElement(O,{label:!0,firstColumn:"Other Abilities",secondColumn:r.a.createElement(C,{name:"Add Ability",small:!0,onClick:function(){return w((function(e){e.otherTraits||(e.otherTraits=[]),e.otherTraits.push({name:"",nameEffects:[{}]})}))}})}),I,r.a.createElement(T,{primaryButtonName:"Save",primaryButtonOnClick:A,secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))};var R=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),l=a[0],c=a[1],u=Object(n.useMemo)((function(){return""===e.unit.name}),[e.unit.name]);if(l||u)return r.a.createElement(I,{deleteUnit:e.deleteUnit,goBack:function(){return u?e.goBack():c(!1)},unit:e.unit,saveUnit:function(t){e.saveUnit(t),c(!1),u&&e.goBack()}});var i=s(e.unit);return r.a.createElement(r.a.Fragment,null,r.a.createElement(S,{subHeaderInfo:[{name:"PL",value:e.unit.powerLevel},{name:"CP",value:i}],headerText:e.unit.name}),r.a.createElement(p,{unit:e.unit}),r.a.createElement(T,{primaryButtonName:"Edit",primaryButtonOnClick:function(){return c(!0)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))};var F=a(111),U=a.n(F),G=a(112);var q=function(e){var t=Object(n.useState)(""===e.crusadeArmy.name),a=Object(o.a)(t,1)[0],l=Object(n.useState)(e.crusadeArmy),c=Object(o.a)(l,2),u=c[0],m=c[1];function s(e){var t=Object(i.a)({},u);e(t),m(t)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{onSubmit:function(){return e.saveArmy(u)}},r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,a?"Add Army":"Edit Army",r.a.createElement("img",{className:"icon",src:H.a,alt:"Edit Links",onClick:function(){window.confirm("Are you sure you wish to delete this army?")&&e.handleDeleteArmy()}}))),r.a.createElement(N,{formName:"Name",onChange:function(e){return s((function(t){return t.name=e.target.value}))},inputType:"textbox",value:u.name}),r.a.createElement(N,{formName:"Requisition Points",onChange:function(e){return s((function(t){return t.requisitionPoints=Number.parseInt(e.target.value)}))},inputType:"number",value:u.requisitionPoints}),r.a.createElement(N,{formName:"Max PL",onChange:function(e){return s((function(t){return t.maximumPowerLevel=Number.parseInt(e.target.value)}))},inputType:"number",value:u.maximumPowerLevel}),r.a.createElement(h,{formName:"Trait",onNameChange:function(e){return s((function(t){t.detachmentTrait||(t.detachmentTrait={}),t.detachmentTrait.name=e.target.value}))},nameEffect:u.detachmentTrait,onEffectChange:function(e){return s((function(t){t.detachmentTrait||(t.detachmentTrait={}),t.detachmentTrait.effect=e.target.value}))}}),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(G.CirclePicker,{width:"90vw",onChange:function(e){return s((function(t){return t.traitColor=e.hex}))},color:u.traitColor||"blue",colors:["#FF0000","#0000FF","#ebdb00","#6b6b6b","#00a00d","#a00097","#00a7a2","#996401"]}))),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,"Copy from Clipboard")),r.a.createElement(f.a,null,r.a.createElement("img",{className:"icon",src:U.a,alt:"Edit Links",onClick:function(){return function(e){if(navigator.clipboard){var t=JSON.stringify(e);navigator.clipboard.writeText(t).then((function(){window.alert("Copied to clipboard")})).catch((function(){window.alert("Can't copy to clipboard")}))}else window.alert("Can't copy to clipboard")}(e.crusadeArmy)}}))),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Control,{as:"textarea",rows:5,onChange:function(e){var t=JSON.parse(e.target.value);t.id=u.id,m(t)},value:JSON.stringify(u)}))),r.a.createElement(T,{primaryButtonName:"Save",primaryButtonOnClick:function(){return e.saveArmy(u)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack,color:u.traitColor})))};var D=function(e){var t,a,l=Object(n.useState)(null!==(t=e.crusadeArmy.requisitionPoints)&&void 0!==t?t:0),c=Object(o.a)(l,2),m=c[0],s=c[1],E=Object(n.useState)(null!==(a=e.crusadeArmy.maximumPowerLevel)&&void 0!==a?a:0),v=Object(o.a)(E,2),b=v[0],p=v[1],g=Object(n.useState)([]),k=Object(o.a)(g,2),N=k[0],j=k[1],A=Object(n.useState)([]),w=Object(o.a)(A,2),B=w[0],P=w[1],x=Object(n.useState)([]),L=Object(o.a)(x,2),H=L[0],I=L[1],R=[r.a.createElement("option",{value:-1})],F=[r.a.createElement("option",{value:-1})],U=[r.a.createElement("option",{value:-1})];e.crusadeArmy.units.forEach((function(e){e.warlordTrait||R.push(r.a.createElement("option",{value:e.id},e.name)),e.relic||F.push(r.a.createElement("option",{value:e.id},e.name)),e.battleScars.find((function(e){return void 0!==e}))&&U.push(r.a.createElement("option",{value:e.id},e.name))}));var G=[];null===N||void 0===N||N.forEach((function(e,t){G.push(r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,{className:"pr-0"},r.a.createElement(y.a.Control,{onChange:function(a){var n=Object(u.a)(N);null===n||void 0===n||n.splice(t,1,Object(i.a)(Object(i.a)({},e),{},{id:Number.parseInt(a.target.value)})),j(n)},value:e.id,as:"select"},R)),r.a.createElement(f.a,null,r.a.createElement(C,{name:"Remove",small:!0,onClick:function(){var e=Object(u.a)(N);null===e||void 0===e||e.splice(t,1),j(e),s(m+1)}}))),r.a.createElement(h,{onNameChange:function(a){var n=Object(u.a)(N);e.nameEffect.name=a.target.value,null===n||void 0===n||n.splice(t,1,e),j(n)},onEffectChange:function(a){var n=Object(u.a)(N);e.nameEffect.effect=a.target.value,null===n||void 0===n||n.splice(t,1,e),j(n)},nameEffect:e.nameEffect})))}));var q=[];null===B||void 0===B||B.forEach((function(e,t){q.push(r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,{className:"pr-0"},r.a.createElement(y.a.Control,{onChange:function(a){var n=Object(u.a)(B);null===n||void 0===n||n.splice(t,1,Object(i.a)(Object(i.a)({},e),{},{id:Number.parseInt(a.target.value)})),P(n)},value:e.id,as:"select"},F)),r.a.createElement(f.a,null,r.a.createElement(C,{name:"Remove",small:!0,onClick:function(){var e=Object(u.a)(B);null===e||void 0===e||e.splice(t,1),P(e),s(m+1)}}))),r.a.createElement(h,{onNameChange:function(a){var n=Object(u.a)(N);e.nameEffect.name=a.target.value,null===n||void 0===n||n.splice(t,1,e),P(n)},onEffectChange:function(a){var n=Object(u.a)(B);e.nameEffect.effect=a.target.value,null===n||void 0===n||n.splice(t,1,e),P(n)},nameEffect:e.nameEffect})))}));var D=[];return null===H||void 0===H||H.forEach((function(t,a){var n=[];if(void 0!==t.id&&-1!==t.id){var l=e.crusadeArmy.units.find((function(e){return e.id===t.id})),c=[];null===l||void 0===l||l.battleScars.forEach((function(e){c.push(r.a.createElement("option",{value:e.name},e.name))})),n.push(r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Control,{onChange:function(e){var n=Object(u.a)(H);null===n||void 0===n||n.splice(a,1,Object(i.a)(Object(i.a)({},t),{},{name:e.target.value})),I(n)},value:t.name,as:"select"},c))))}D.push(r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,{className:"pr-0"},r.a.createElement(y.a.Control,{onChange:function(e){var n=Object(u.a)(H);null===n||void 0===n||n.splice(a,1,Object(i.a)(Object(i.a)({},t),{},{id:Number.parseInt(e.target.value)})),I(n)},value:t.id,as:"select"},U)),r.a.createElement(f.a,null,r.a.createElement(C,{name:"Remove",small:!0,onClick:function(){var e=Object(u.a)(H);null===e||void 0===e||e.splice(a,1),I(e),s(m+1)}}))),n))})),r.a.createElement(r.a.Fragment,null,r.a.createElement(S,{headerText:"RP Spending"}),r.a.createElement(O,{firstColumn:"Requisition Points",secondColumn:m}),r.a.createElement(O,{firstColumn:"Maximum Power Level",secondColumn:b}),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(C,{onClick:function(){p(b-5),s(m+1)},name:"Undo"})),r.a.createElement(f.a,null,r.a.createElement(C,{onClick:function(){p(b+5),s(m-1)},name:"Increase Supply Limit"}))),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(C,{onClick:function(){var e=[].concat(Object(u.a)(N),[{id:-1,nameEffect:{}}]);s(m-1),j(e)},name:"Warlord Trait"}))),G,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(C,{onClick:function(){var e=[].concat(Object(u.a)(B),[{id:-1,nameEffect:{}}]);s(m-1),P(e)},name:"Relic"}))),q,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(C,{name:"Repair and Recuperate",onClick:function(){var e=[].concat(Object(u.a)(H),[{id:-1}]);s(m-1),I(e)}}))),D,r.a.createElement(T,{secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack,primaryButtonName:"Save",primaryButtonOnClick:function(){var t=Object(i.a)({},e.crusadeArmy);t.maximumPowerLevel=b,t.requisitionPoints=m,N.forEach((function(e){var a=t.units.find((function(t){return t.id===e.id}));a&&(a.warlordTrait=e.nameEffect)})),B.forEach((function(e){var a=t.units.find((function(t){return t.id===e.id}));a&&(a.relic=e.nameEffect)})),H.forEach((function(e){var a=t.units.find((function(t){return t.id===e.id}));a&&(a.battleScars=a.battleScars.filter((function(t){return(null===t||void 0===t?void 0:t.name)===e.name})))})),e.updateArmy(t),e.goBack()}}))},J=a(113),M=a(304),W=a(303),X=a(299),K=a(116),z=a(114),V=a.n(z);function $(e){var t=r.a.useRef(null),a=r.a.useRef(null),n=Object(M.a)({accept:"row",hover:function(a,n){var r;if(t.current){var l=a.index,c=e.index;if(l!==c){var o=t.current.getBoundingClientRect(),u=(o.bottom-o.top)/2,i=n.getClientOffset(),m=(null!==(r=null===i||void 0===i?void 0:i.y)&&void 0!==r?r:0)-o.top;l<c&&m<u||l>c&&m>u||(e.moveRow&&e.moveRow(l,c),a.index=c)}}}}),l=Object(o.a)(n,2)[1],c=e.index,u=Object(W.a)({item:{type:"row",index:c},collect:function(e){return{isDragging:e.isDragging()}}}),i=Object(o.a)(u,3),m=i[0].isDragging,s=i[1],d=m?0:1;return(0,i[2])(l(t)),s(a),r.a.createElement("tr",{ref:t,style:{opacity:d}},r.a.createElement("td",{ref:a,style:{width:"36px"}},r.a.createElement("img",{className:"icon",src:V.a,alt:"Move Unit"})),e.row.cells.map((function(t){return r.a.createElement("td",Object.assign({},t.getCellProps(),{onClick:e.onRowClick}),t.render("Cell"))})))}var Q=function(e){var t=r.a.useMemo((function(){return e.columns}),[e.columns]),a=e.units.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{crusadePoints:s(e)})})),n=r.a.useCallback((function(e){return e.id}),[]),l=Object(J.useTable)({data:a,columns:t,getRowId:n}),c=l.getTableProps,o=l.getTableBodyProps,u=l.headerGroups,m=l.rows,d=l.prepareRow;function f(t,a){var n=e.units[t];e.updateRowPosition&&e.updateRowPosition(n.id,a)}return r.a.createElement(X.a,{backend:K.a,options:{enableMouseEvents:!0}},r.a.createElement("table",Object.assign({},c(),{className:"table table-striped table-bordered table-hover"}),r.a.createElement("thead",null,u.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),r.a.createElement("th",null),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(),e.render("Header"))})))}))),r.a.createElement("tbody",o(),m.map((function(t,a){return d(t),r.a.createElement($,Object.assign({index:a,row:t,onRowClick:function(){return e.onRowClick(t.original.id)},moveRow:f,updateRowPosition:e.updateRowPosition},t.getRowProps()))})))))};var Y=function(e){var t=Object(n.useState)(),a=Object(o.a)(t,2),l=a[0],c=a[1],m=Object(n.useState)(),E=Object(o.a)(m,2),b=E[0],p=E[1],h=Object(n.useState)(),g=Object(o.a)(h,2),k=g[0],N=g[1],j=Object(n.useState)(),A=Object(o.a)(j,2),w=A[0],B=A[1],P=Object(n.useState)(),L=Object(o.a)(P,2),H=L[0],I=L[1];function F(t){e.updateArmy(t),N(!1),p(!1)}Object(n.useEffect)((function(){var t=e.crusadeArmy.units.map((function(e){var t=s(e);return r.a.createElement("tr",{key:e.id,className:"read-only-display-item",onClick:function(){return c(e)}},r.a.createElement("td",null,e.name),r.a.createElement("td",{style:{whiteSpace:"nowrap"}},t),r.a.createElement("td",null,e.powerLevel))}));I(t)}),[e.crusadeArmy,l,k]);var U=0,G=0;if(e.crusadeArmy.units.forEach((function(e){U+=s(e),G+=e.powerLevel})),b)return r.a.createElement(q,{crusadeArmy:e.crusadeArmy,goBack:function(){return p(!1)},handleDeleteArmy:function(){return e.deleteArmy(e.crusadeArmy)},saveArmy:F});if(k||e.crusadeArmy.battleRosterUnitIds)return r.a.createElement(x,{crusadeArmy:e.crusadeArmy,goBack:function(){return N(!1)},updateArmy:F});if(l)return r.a.createElement(R,{deleteUnit:function(t){var a=Object(i.a)({},e.crusadeArmy),n=a.units.findIndex((function(e){return e.id===t.id}));n>=0&&a.units.splice(n,1),e.updateArmy(a),c(void 0)},goBack:function(){return c(void 0)},saveUnit:function(t){var a=Object(i.a)({},e.crusadeArmy),n=a.units.findIndex((function(e){return e.id===t.id}));n>=0?a.units.splice(n,1,t):a.units.push(t),e.updateArmy(a),c(t)},unit:l});if(w)return r.a.createElement(D,{goBack:function(){return B(!1)},crusadeArmy:e.crusadeArmy,updateArmy:F});var J=null;if(0!==(null===H||void 0===H?void 0:H.length)){J=r.a.createElement(Q,{columns:[{Header:"Name",accessor:"name"},{Header:"CP",accessor:"crusadePoints"},{Header:"PL",accessor:"powerLevel"}],units:e.crusadeArmy.units,updateRowPosition:function(t,a){var n=Object(u.a)(e.crusadeArmy.units),r=n.findIndex((function(e){return e.id===t})),l=n.splice(r,1);n.splice(a,0,l[0]);var c=Object(i.a)({},e.crusadeArmy);c.units=n,e.updateArmy(c)},onRowClick:function(t){var a=e.crusadeArmy.units.find((function(e){return e.id===t}));a&&c(a)}})}var M=void 0;return e.crusadeArmy.detachmentTrait&&(M=r.a.createElement(v,{header:"Detachment Trait",nameEffects:[e.crusadeArmy.detachmentTrait]})),r.a.createElement(r.a.Fragment,null,r.a.createElement(S,{subHeaderInfo:[{name:"PL",value:G},{name:"CP",value:U}],headerText:e.crusadeArmy.name,onEdit:function(){return p(!0)}}),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,"Requisition Points:")," "+e.crusadeArmy.requisitionPoints),r.a.createElement(f.a,null,r.a.createElement(C,{name:"Spend",onClick:function(){return B(!0)}}))),M,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,r.a.createElement("h3",null,"Units"))),r.a.createElement(f.a,null,r.a.createElement(C,{name:"Add",onClick:function(){var t=0;e.crusadeArmy.units.forEach((function(e){e.id>t&&(t=e.id)})),c({id:t+1,agendaXp:0,battleHonours:[],battleParticipation:0,crusadePoints:0,kills:0,markedForGreatness:0,name:"",notes:"",battleScars:[],powerLevel:0})}}))),r.a.createElement(O,{firstColumn:"Power Level",secondColumn:G+"/"+e.crusadeArmy.maximumPowerLevel}),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,J)),r.a.createElement(T,{primaryButtonName:"Battle!",primaryButtonOnClick:function(){return N(!0)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))};a(294);var Z=function(){var e=Object(n.useState)(),t=Object(o.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(),u=Object(o.a)(c,2),i=u[0],m=u[1],v=Object(n.useState)(),b=Object(o.a)(v,2),p=b[0],y=b[1],h=Object(n.useState)(),C=Object(o.a)(h,2),k=C[0],N=C[1];function O(e){var t=JSON.parse(window.localStorage.getItem("crusadeArmies")||"[]"),a=t.findIndex((function(t){return t.id===e.id}));a>=0?t.splice(a,1,e):t.push(e),window.localStorage.setItem("crusadeArmies",JSON.stringify(t)),m(t);var n=t.find((function(t){return t.id===e.id}));y(n)}function j(e){var t=JSON.parse(window.localStorage.getItem("crusadeArmies")||"[]"),a=t.findIndex((function(t){return t.id===e.id}));a>=0&&t.splice(a,1),window.localStorage.setItem("crusadeArmies",JSON.stringify(t)),m(t),y(void 0)}return Object(n.useEffect)((function(){var e=JSON.parse(window.localStorage.getItem("crusadeArmies")||"[]");m(e)}),[]),Object(n.useEffect)((function(){if(i){var e=i.map((function(e,t){var a=0,n=0;return e.units.forEach((function(e){a+=s(e),n+=e.powerLevel})),r.a.createElement(E.a,{className:"mb-3",key:t,onClick:function(){return y(e)},style:{border:"1px solid ".concat(e.traitColor||"rgb(0, 123, 255)")}},r.a.createElement(E.a.Body,null,r.a.createElement(E.a.Title,{as:"h2"},e.name),r.a.createElement(E.a.Text,null,n+" PL ",a+" CP ",e.requisitionPoints+" RP")))}));N(e)}}),[i]),a?r.a.createElement(q,{crusadeArmy:a,handleDeleteArmy:function(){return j(a)},goBack:function(){return l(void 0)},saveArmy:O}):p?r.a.createElement(ee.Provider,{value:p.traitColor||"blue"},r.a.createElement(Y,{deleteArmy:j,crusadeArmy:p,goBack:function(){return y(void 0)},updateArmy:O})):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,"Crusade Armies")),r.a.createElement(d.a,{className:"flex-grow-1",style:{overflow:"auto"}},r.a.createElement(f.a,null,k)),r.a.createElement(d.a,{md:"2"},r.a.createElement(f.a,{xs:4},r.a.createElement(g.a,{block:!0,size:"lg",variant:"primary",onClick:function(){var e,t={name:"",id:null!==(e=null===i||void 0===i?void 0:i.length)&&void 0!==e?e:0,maximumPowerLevel:50,requisitionPoints:5,units:[]};l(t)}},"Add"))))},_=a(300),ee=r.a.createContext("blue");var te=function(){return r.a.createElement(_.a,{fluid:!0,className:"h-100"},r.a.createElement(Z,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},47:function(e,t,a){e.exports=a.p+"static/media/DeleteIcon.0d10f8f1.svg"}},[[117,1,2]]]);
//# sourceMappingURL=main.ebfc990a.chunk.js.map