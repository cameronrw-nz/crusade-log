(this["webpackJsonpcrusade-log"]=this["webpackJsonpcrusade-log"]||[]).push([[0],{101:function(e,t,a){e.exports=a(276)},106:function(e,t,a){},107:function(e,t,a){},276:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(96),c=a.n(l),o=(a(106),a(107),a(6)),u=a(8),i=a(18);function m(e){var t=0;e.outOfAction&&e.outOfAction.forEach((function(e){e.isActive&&e.xp&&(t+=e.xp)}));var a=e.battleParticipation+3*e.markedForGreatness+e.agendaXp+Math.floor(e.kills/3)-t;return a>0?a:0}function s(e){var t,a,n=e.warlordTrait?1:0,r=e.battleHonours&&e.battleHonours.length>0?null===(t=e.battleHonours)||void 0===t||null===(a=t.map((function(e){return e.crusadePoints})))||void 0===a?void 0:a.reduce((function(e,t){return(null!==e&&void 0!==e?e:0)+t})):0,l=0;return e.outOfAction&&e.outOfAction.forEach((function(e){e.battleScar&&l--})),n+r+l}var d=a(277),f=a(97),E=a(281);var b=function(e){var t=[];return e.nameEffects.forEach((function(e){t.push(r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a.Subtitle,{className:"mt-1 ml-2"},e.name),r.a.createElement(E.a.Text,{className:"ml-2"},e.effect)))})),r.a.createElement(d.a,{className:"mb-3"},r.a.createElement(f.a,null,r.a.createElement(E.a,null,r.a.createElement(E.a.Header,{className:"py-1"},e.header),t)))};var v,p=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),l=a[0],c=a[1],u=m(e.unit),i=null;e.unit.warlordTrait&&(i=r.a.createElement(b,{header:"Warlord Trait",nameEffects:[e.unit.warlordTrait]}));var s=void 0;if(e.unit.battleHonours&&e.unit.battleHonours.length>0){var E=[];e.unit.battleHonours.forEach((function(e){e.battleTrait&&E.push(e.battleTrait)})),s=r.a.createElement(b,{header:"Battle Honours",nameEffects:E})}var v=void 0;if(e.unit.outOfAction&&e.unit.outOfAction.length>0){var p=[];e.unit.outOfAction.forEach((function(e){e.isActive&&e.battleScar&&p.push(e.battleScar)})),v=r.a.createElement(b,{header:"Battle Scars",nameEffects:p})}var y=null;return l&&(y=r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Battle Participation"),r.a.createElement(f.a,null,e.unit.battleParticipation)),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Marked For Greatness"),r.a.createElement(f.a,null,e.unit.markedForGreatness)),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Agenda"),r.a.createElement(f.a,null,e.unit.agendaXp)),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Kills"),r.a.createElement(f.a,null,e.unit.kills)))),r.a.createElement(r.a.Fragment,null,i,s,v,r.a.createElement(d.a,{className:"mb-2",onClick:function(){c(!l)}},r.a.createElement(f.a,null,"Total Experience"),r.a.createElement(f.a,null,u)),y)};!function(e){e.BattleReady="Battle-Ready",e.Blooded="Blooded",e.BattleHardened="Battle-Hardened",e.Heroic="Heroic",e.Legendary="Legendary"}(v||(v={}));var y=a(280),h=a(282);var g=function(e){function t(t){t.preventDefault(),e.editUnit((function(e){var t=e.outOfAction;t||(t=[]),t.push({isActive:!0}),e.outOfAction=t}))}function a(t,a){e.editUnit((function(e){var n=Object(u.a)({},e.outOfAction[a]);t(n),e.outOfAction.splice(a,1,n)}))}var n=[];return e.unit.outOfAction&&e.unit.outOfAction.length>0&&(n.push(r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,"Battle Scar"),r.a.createElement(f.a,null,"Out Of Action"))),e.unit.outOfAction.forEach((function(e,t){var l;e.isActive&&n.push(r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,{className:"pr-1"},r.a.createElement(y.a.Control,{type:"textbox",onChange:function(e){return a((function(t){return t.battleScar.effect=e.target.value}),t)},value:null===(l=e.battleScar)||void 0===l?void 0:l.effect,placeholder:"Name"})),r.a.createElement(f.a,{className:"pl-1"},r.a.createElement(y.a.Control,{type:"textbox",onChange:function(e){return a((function(t){return t.xp=Number.parseInt(e.target.value)}),t)},value:e.xp,placeholder:"Effect"}))))}))),r.a.createElement(z.Consumer,null,(function(e){return r.a.createElement(y.a.Group,{as:d.a,className:"mb-2",controlId:"formWarlordTrait"},r.a.createElement(f.a,null,r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,"Out Of Action")),r.a.createElement(f.a,null,r.a.createElement(h.a,{variant:"outline-primary",onClick:t,type:"button",block:!0,style:{borderColor:e,color:e}},"Add"))),n))}))};var k=function(e){return r.a.createElement(y.a.Group,{as:d.a,className:"mb-2",controlId:"form".concat(e.formName)},r.a.createElement(f.a,{xs:e.resetFirstColSpan?void 0:4},r.a.createElement(y.a.Label,null,e.formName)),r.a.createElement(f.a,null,r.a.createElement(y.a.Control,{type:e.inputType,onChange:e.onChange,value:e.value,placeholder:e.placeHolder||e.formName})))};var C=function(e){var t=e.firstColumn;return e.label&&(t=r.a.createElement(y.a.Label,null,e.firstColumn)),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,t),r.a.createElement(f.a,null,e.secondColumn))};var N=function(e){var t=m(e.unit)+1,a=Object(n.useState)(t-1),l=Object(o.a)(a,1)[0],c=0,s=e.unit.battleHonours.map((function(t){var a,n;return c+=t.crusadePoints,t.rank===v.Blooded&&l<6||t.rank===v.BattleHardened&&l<16||t.rank===v.Heroic&&l<31||t.rank===v.Legendary&&l<51?r.a.createElement(k,{resetFirstColSpan:!0,inputType:"textbox",onChange:function(a){var n=Object(u.a)({},e.unit),r=n.battleHonours.find((function(e){return e.rank===t.rank}));(null===r||void 0===r?void 0:r.battleTrait)||(r.battleTrait={}),r.battleTrait.effect=a.target.value,e.updateUnit(n)},formName:t.rank,value:(null===(n=t.battleTrait)||void 0===n?void 0:n.effect)||""}):r.a.createElement(C,{firstColumn:t.rank,label:!0,secondColumn:(null===(a=t.battleTrait)||void 0===a?void 0:a.effect)||""})}));return r.a.createElement(z.Consumer,null,(function(a){return r.a.createElement(d.a,null,r.a.createElement(f.a,null,r.a.createElement("h3",{className:"mt-3",style:{borderTop:"1px solid ".concat(a)}},e.unit.name),r.a.createElement(C,{firstColumn:"Crusade Points",label:!0,secondColumn:c}),r.a.createElement(C,{firstColumn:"Battle Participation",label:!0,secondColumn:"".concat(e.unit.battleParticipation," + 1")}),r.a.createElement(k,{resetFirstColSpan:!0,inputType:"number",onChange:function(t){var a=Object(u.a)({},e.unit);a.markedForGreatness=Number.parseInt(t.target.value),e.updateUnit(a)},formName:"Greatness",value:e.unit.markedForGreatness}),r.a.createElement(k,{resetFirstColSpan:!0,inputType:"number",onChange:function(t){var a=Object(u.a)({},e.unit);a.agendaXp=Number.parseInt(t.target.value),e.updateUnit(a)},formName:"Agenda",value:e.unit.agendaXp}),r.a.createElement(k,{resetFirstColSpan:!0,inputType:"number",onChange:function(t){var a=Object(u.a)({},e.unit);a.kills=Number.parseInt(t.target.value),e.updateUnit(a)},formName:"Kills",value:e.unit.kills}),r.a.createElement(C,{firstColumn:"Total Experience",label:!0,secondColumn:t}),s,r.a.createElement(g,{unit:e.unit,editUnit:function(t){var a=Object(u.a)(Object(u.a)({},e.unit),{},{outOfAction:Object(i.a)(e.unit.outOfAction||[])});t(a),e.updateUnit(a)}})))}))};var O=function(e){return r.a.createElement(z.Consumer,null,(function(t){return r.a.createElement(d.a,{className:"mb-2"},e.tertiaryButtonOnClick&&e.tertiaryButtonName&&r.a.createElement(f.a,null,r.a.createElement(h.a,{block:!0,size:"lg",variant:"outline-primary",onClick:e.tertiaryButtonOnClick,type:"button",style:{borderColor:e.color||t,color:e.color||t}},e.tertiaryButtonName)),r.a.createElement(f.a,null,r.a.createElement(h.a,{block:!0,size:"lg",variant:"outline-primary",onClick:e.secondaryButtonOnClick,type:"button",style:{borderColor:e.color||t,color:e.color||t}},e.secondaryButtonName)),r.a.createElement(f.a,null,r.a.createElement(h.a,{block:!0,size:"lg",variant:"primary",onClick:e.primaryButtonOnClick,type:"submit",style:{borderColor:e.color||t,backgroundColor:e.color||t}},e.primaryButtonName)))}))};var A=function(e){var t=Object(n.useState)(e.crusadeArmy.units),a=Object(o.a)(t,2),l=a[0],c=a[1],s=Object(n.useState)(1),f=Object(o.a)(s,2),E=f[0],b=f[1],p=l.map((function(t,a){var n;if(null===(n=e.crusadeArmy.battleRosterUnitIds)||void 0===n?void 0:n.includes(a))return r.a.createElement(N,{unit:t,updateUnit:function(e){return function(e,t){var a=Object(i.a)(l),n=m(e)+1;e.battleHonours.findIndex((function(e){return e.rank===v.Blooded}))<0&&n>=6?e.battleHonours.push({crusadePoints:e.powerLevel>=11?2:1,battleTrait:{effect:""},rank:v.Blooded}):e.battleHonours.findIndex((function(e){return e.rank===v.BattleHardened}))<0&&n>=16?e.battleHonours.push({crusadePoints:e.powerLevel>=11?2:1,battleTrait:{effect:""},rank:v.BattleHardened}):e.battleHonours.findIndex((function(e){return e.rank===v.Heroic}))<0&&n>=31?e.battleHonours.push({crusadePoints:e.powerLevel>=11?2:1,battleTrait:{effect:""},rank:v.Heroic}):e.battleHonours.findIndex((function(e){return e.rank===v.Legendary}))<0&&n>=51&&e.battleHonours.push({crusadePoints:e.powerLevel>=11?2:1,battleTrait:{effect:""},rank:v.Legendary}),a.splice(t,1,e),c(a)}(e,a)}})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,"Fill Unit Stats")),r.a.createElement(y.a,null,r.a.createElement(k,{resetFirstColSpan:!0,formName:"RP",inputType:"number",onChange:function(e){return b(Number.parseInt(e.target.value))},value:E}),p,r.a.createElement(O,{primaryButtonName:"Save",primaryButtonOnClick:function(){var t=Object(u.a)({},e.crusadeArmy);t.units=l,l.forEach((function(e){return e.battleParticipation++})),t.battleRosterUnitIds=void 0,e.updateArmy(t)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack})))};var B=function(e){var t,a=Object(n.useState)(),l=Object(o.a)(a,2),c=l[0],u=l[1],i=[];return null===(t=e.crusadeArmy.battleRosterUnitIds)||void 0===t||t.forEach((function(t){var a=e.crusadeArmy.units.find((function(e){return e.id===t}));a&&(i.push(r.a.createElement(z.Consumer,null,(function(e){return r.a.createElement("h3",{className:"mt-3",style:{borderTop:"1px solid ".concat(e)}},a.name)}))),i.push(r.a.createElement(p,{unit:a,key:t})))})),c?r.a.createElement(A,{crusadeArmy:e.crusadeArmy,goBack:function(){return u(!1)},updateArmy:e.updateArmy}):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,"Battle Roster")),i,r.a.createElement(O,{primaryButtonName:"Continue",primaryButtonOnClick:function(){return u(!0)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))};var w=function(e){var t=Object(n.useState)([]),a=Object(o.a)(t,2),l=a[0],c=a[1],m=e.crusadeArmy.units.map((function(e){return r.a.createElement(z.Consumer,null,(function(t){return r.a.createElement(y.a.Group,{onClick:function(){return function(e){var t=[];t=l.includes(e)?l.filter((function(t){return t!==e})):[].concat(Object(i.a)(l),[e]),c(t)}(e.id)},className:"mb-1"},r.a.createElement(y.a.Check,{type:"checkbox",className:"custom-control",color:t},r.a.createElement(y.a.Check.Input,{className:"custom-control-input mr-1",color:t,checked:l.includes(e.id),style:{position:"relative"}}),r.a.createElement(y.a.Check.Label,{className:"custom-control-label",children:"".concat(e.name," ").concat(e.powerLevel," PL"),style:{fontWeight:"unset"}})))}))})),s=0;return e.crusadeArmy.units.map((function(e,t){l.includes(e.id)&&(s+=e.powerLevel)})),e.crusadeArmy.battleRosterUnitIds?r.a.createElement(B,{crusadeArmy:e.crusadeArmy,goBack:function(){var t=Object(u.a)({},e.crusadeArmy);t.battleRosterUnitIds=void 0,e.updateArmy(t)},updateArmy:e.updateArmy}):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,"Select Battle Roster")),r.a.createElement("p",null,"Selected Power Level:"," "+s),r.a.createElement(y.a,null,m),r.a.createElement(O,{primaryButtonName:"Continue",primaryButtonOnClick:function(){var t=Object(u.a)({},e.crusadeArmy);t.battleRosterUnitIds=l,e.updateArmy(t)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))},T=a(40),j=a.n(T);var x=function(e){var t,a,n=void 0;return e.formName&&(n=r.a.createElement(d.a,null,r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,e.formName)))),r.a.createElement(y.a.Group,{as:d.a,className:"mb-2",controlId:"form".concat(e.formName)},r.a.createElement(f.a,null,n,r.a.createElement(d.a,null,r.a.createElement(f.a,{className:"pr-1"},r.a.createElement(y.a.Control,{type:"textbox",onChange:e.onNameChange,value:null===(t=e.nameEffect)||void 0===t?void 0:t.name,placeholder:"Name"})),r.a.createElement(f.a,{className:"pl-1"},r.a.createElement(y.a.Control,{type:"textbox",onChange:e.onEffectChange,value:null===(a=e.nameEffect)||void 0===a?void 0:a.effect,placeholder:"Effect"})))))};var S=function(e){var t=Object(n.useState)(""===e.unit.name),a=Object(o.a)(t,1)[0],l=Object(n.useState)(e.unit),c=Object(o.a)(l,2),s=c[0],f=c[1];function E(t){t.preventDefault(),t.stopPropagation(),e.saveUnit(s)}function b(e){var t=Object(u.a)(Object(u.a)({},s),{},{battleHonours:Object(i.a)(s.battleHonours),outOfAction:Object(i.a)(s.outOfAction||[])});e(t);var a=m(t);t.battleHonours.findIndex((function(e){return e.rank===v.Blooded}))<0&&a>=6?t.battleHonours.push({crusadePoints:t.powerLevel>=11?2:1,battleTrait:{effect:""},rank:v.Blooded}):t.battleHonours.findIndex((function(e){return e.rank===v.BattleHardened}))<0&&a>=16?t.battleHonours.push({crusadePoints:t.powerLevel>=11?2:1,battleTrait:{effect:""},rank:v.BattleHardened}):t.battleHonours.findIndex((function(e){return e.rank===v.Heroic}))<0&&a>=31?t.battleHonours.push({crusadePoints:t.powerLevel>=11?2:1,battleTrait:{effect:""},rank:v.Heroic}):t.battleHonours.findIndex((function(e){return e.rank===v.Legendary}))<0&&a>=51&&t.battleHonours.push({crusadePoints:t.powerLevel>=11?2:1,battleTrait:{effect:""},rank:v.Legendary}),f(t)}var p=m(s),h=0,N=s.battleHonours.map((function(e,t){var a;return h+=e.crusadePoints,r.a.createElement(k,{key:t,formName:e.rank,inputType:"textbox",onChange:function(t){b((function(a){var n=a.battleHonours.find((function(t){return t.rank===e.rank}));(null===n||void 0===n?void 0:n.battleTrait)||(n.battleTrait={}),n.battleTrait.effect=t.target.value}))},value:null===(a=e.battleTrait)||void 0===a?void 0:a.effect})}));return r.a.createElement(y.a,{onSubmit:E,id:"edit-unit"},r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,a?"Adding Unit ":"Editting Unit ",r.a.createElement("img",{className:"icon",src:j.a,alt:"Edit Links",onClick:function(){window.confirm("Are you sure you wish to delete this unit?")&&e.deleteUnit(e.unit)}}))),r.a.createElement(k,{formName:"Name",inputType:"textbox",onChange:function(e){return b((function(t){return t.name=e.target.value}))},value:s.name}),r.a.createElement(k,{formName:"Power Level",inputType:"number",onChange:function(e){return b((function(t){return t.powerLevel=Number.parseInt(e.target.value)}))},value:s.powerLevel}),r.a.createElement(k,{formName:"Participation",inputType:"number",onChange:function(e){return b((function(t){return t.battleParticipation=Number.parseInt(e.target.value)}))},value:s.battleParticipation}),r.a.createElement(k,{formName:"Greatness",inputType:"number",onChange:function(e){return b((function(t){return t.markedForGreatness=Number.parseInt(e.target.value)}))},value:s.markedForGreatness}),r.a.createElement(k,{formName:"Agenda",inputType:"number",onChange:function(e){return b((function(t){return t.agendaXp=Number.parseInt(e.target.value)}))},value:s.agendaXp}),r.a.createElement(k,{formName:"Kills",inputType:"number",onChange:function(e){return b((function(t){return t.kills=Number.parseInt(e.target.value)}))},value:s.kills}),r.a.createElement(C,{label:!0,firstColumn:"Total Experience",secondColumn:p}),N,r.a.createElement(g,{unit:s,editUnit:b}),r.a.createElement(x,{formName:"Warlord Trait",onNameChange:function(e){return b((function(t){t.warlordTrait||(t.warlordTrait={}),t.warlordTrait.name=e.target.value}))},onEffectChange:function(e){return b((function(t){t.warlordTrait||(t.warlordTrait={}),t.warlordTrait.effect=e.target.value}))},nameEffect:s.warlordTrait}),r.a.createElement(C,{label:!0,firstColumn:"Crusade Points",secondColumn:h}),r.a.createElement(O,{primaryButtonName:"Save",primaryButtonOnClick:E,secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))},H=a(98),I=a.n(H);var L=function(e){var t=void 0;return e.onEdit&&(t=r.a.createElement("img",{className:"icon",src:I.a,alt:"Edit Links",onClick:e.onEdit})),r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,e.headerText,t),r.a.createElement("div",null,r.a.createElement("div",{className:"heading-sub-header"},r.a.createElement("b",null,e.powerLevel+" "),"PL"),r.a.createElement("div",{className:"heading-sub-header"},r.a.createElement("b",null,e.crusadePoints+" "),"CP")))};var P=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),l=a[0],c=a[1],u=Object(n.useMemo)((function(){return""===e.unit.name}),[]);if(l||u)return r.a.createElement(S,{deleteUnit:e.deleteUnit,goBack:function(){return u?e.goBack():c(!1)},unit:e.unit,saveUnit:function(t){e.saveUnit(t),c(!1),u&&e.goBack()}});var i=s(e.unit);return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,{crusadePoints:i,headerText:e.unit.name,powerLevel:e.unit.powerLevel}),r.a.createElement(p,{unit:e.unit}),r.a.createElement(O,{primaryButtonName:"Edit",primaryButtonOnClick:function(){return c(!0)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack}))};var F=a(99),U=a.n(F),G=a(100);var R=function(e){var t=Object(n.useState)(""===e.crusadeArmy.name),a=Object(o.a)(t,1)[0],l=Object(n.useState)(e.crusadeArmy),c=Object(o.a)(l,2),i=c[0],m=c[1];function s(e){var t=Object(u.a)({},i);e(t),m(t)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{onSubmit:function(){return e.saveArmy(i)}},r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,a?"Add Army":"Edit Army",r.a.createElement("img",{className:"icon",src:j.a,alt:"Edit Links",onClick:function(){window.confirm("Are you sure you wish to delete this army?")&&e.handleDeleteArmy()}}))),r.a.createElement(k,{formName:"Name",onChange:function(e){return s((function(t){return t.name=e.target.value}))},inputType:"textbox",value:i.name}),r.a.createElement(x,{formName:"Trait",onNameChange:function(e){return s((function(t){t.detachmentTrait||(t.detachmentTrait={}),t.detachmentTrait.name=e.target.value}))},nameEffect:i.detachmentTrait,onEffectChange:function(e){return s((function(t){t.detachmentTrait||(t.detachmentTrait={}),t.detachmentTrait.effect=e.target.value}))}}),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(G.CirclePicker,{width:"90vw",onChange:function(e){return s((function(t){return t.traitColor=e.hex}))},color:i.traitColor||"blue",colors:["#FF0000","#0000FF","#ebdb00","#6b6b6b","#00a00d"]}))),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Label,null,"Copy from Clipboard")),r.a.createElement(f.a,null,r.a.createElement("img",{className:"icon",src:U.a,alt:"Edit Links",onClick:function(){return function(e){if(navigator.clipboard){var t=JSON.stringify(e);navigator.clipboard.writeText(t).then((function(){window.alert("Copied to clipboard")})).catch((function(){window.alert("Can't copy to clipboard")}))}else window.alert("Can't copy to clipboard")}(e.crusadeArmy)}}))),r.a.createElement(d.a,{className:"mb-2"},r.a.createElement(f.a,null,r.a.createElement(y.a.Control,{as:"textarea",rows:5,onChange:function(e){var t=JSON.parse(e.target.value);t.id=i.id,m(t)},value:JSON.stringify(i)}))),r.a.createElement(O,{primaryButtonName:"Save",primaryButtonOnClick:function(){return e.saveArmy(i)},secondaryButtonName:"Back",secondaryButtonOnClick:e.goBack,color:i.traitColor})))},J=a(278);var D=function(e){var t=Object(n.useState)(),a=Object(o.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(),m=Object(o.a)(i,2),E=m[0],p=m[1],y=Object(n.useState)(),h=Object(o.a)(y,2),g=h[0],k=h[1],C=Object(n.useState)(),N=Object(o.a)(C,2),A=N[0],B=N[1];function T(t){e.updateArmy(t),k(!1),p(!1)}Object(n.useEffect)((function(){var t=e.crusadeArmy.units.map((function(e){var t,a,n=null!==(t=null===(a=e.battleHonours[e.battleHonours.length-1])||void 0===a?void 0:a.rank)&&void 0!==t?t:v.BattleReady,l=s(e);return r.a.createElement("tr",{key:e.id,className:"read-only-display-item",onClick:function(){return c(e)}},r.a.createElement("td",null,e.name),r.a.createElement("td",{style:{whiteSpace:"nowrap"}},n),r.a.createElement("td",null,l))}));B(t)}),[e.crusadeArmy,l,g]);var j=0,x=0;if(e.crusadeArmy.units.forEach((function(e){j+=s(e),x+=e.powerLevel})),E)return r.a.createElement(R,{crusadeArmy:e.crusadeArmy,goBack:function(){return p(!1)},handleDeleteArmy:function(){return e.deleteArmy(e.crusadeArmy)},saveArmy:T});if(g||e.crusadeArmy.battleRosterUnitIds)return r.a.createElement(w,{crusadeArmy:e.crusadeArmy,goBack:function(){return k(!1)},updateArmy:T});if(l)return r.a.createElement(P,{deleteUnit:function(t){var a=Object(u.a)({},e.crusadeArmy),n=a.units.findIndex((function(e){return e.id===t.id}));n>=0&&a.units.splice(n,1),e.updateArmy(a),c(void 0)},goBack:function(){return c(void 0)},saveUnit:function(t){var a=Object(u.a)({},e.crusadeArmy),n=a.units.findIndex((function(e){return e.id===t.id}));n>=0?a.units.splice(n,1,t):a.units.push(t),e.updateArmy(a),c(t)},unit:l});var S=null;0!==(null===A||void 0===A?void 0:A.length)&&(S=r.a.createElement(J.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Rank"),r.a.createElement("th",null,"CP"))),r.a.createElement("tbody",null,A)));var H=void 0;return e.crusadeArmy.detachmentTrait&&(H=r.a.createElement(b,{header:"Detachment Trait",nameEffects:[e.crusadeArmy.detachmentTrait]})),r.a.createElement(r.a.Fragment,null,r.a.createElement(L,{crusadePoints:j,headerText:e.crusadeArmy.name,powerLevel:x,onEdit:function(){return p(!0)}}),H,r.a.createElement(d.a,null,r.a.createElement(f.a,null,S)),r.a.createElement(O,{primaryButtonName:"Log",primaryButtonOnClick:function(){return k(!0)},secondaryButtonName:"Add",secondaryButtonOnClick:function(){var t=0;e.crusadeArmy.units.forEach((function(e){e.id>t&&(t=e.id)})),c({id:t+1,agendaXp:0,battleHonours:[],battleParticipation:0,crusadePoints:0,kills:0,markedForGreatness:0,name:"",notes:"",outOfAction:[],powerLevel:0})},tertiaryButtonName:"Back",tertiaryButtonOnClick:e.goBack}))};a(275);var X=function(){var e=Object(n.useState)(),t=Object(o.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(),u=Object(o.a)(c,2),i=u[0],m=u[1],b=Object(n.useState)(),v=Object(o.a)(b,2),p=v[0],y=v[1],g=Object(n.useState)(),k=Object(o.a)(g,2),C=k[0],N=k[1];function O(e){var t=JSON.parse(window.localStorage.getItem("crusadeArmies")||"[]"),a=t.findIndex((function(t){return t.id===e.id}));a>=0?t.splice(a,1,e):t.push(e),window.localStorage.setItem("crusadeArmies",JSON.stringify(t)),m(t);var n=t.find((function(t){return t.id===e.id}));y(n)}function A(e){var t=JSON.parse(window.localStorage.getItem("crusadeArmies")||"[]"),a=t.findIndex((function(t){return t.id===e.id}));a>=0&&t.splice(a,1),window.localStorage.setItem("crusadeArmies",JSON.stringify(t)),m(t),y(void 0)}return Object(n.useEffect)((function(){var e=JSON.parse(window.localStorage.getItem("crusadeArmies")||"[]");m(e)}),[]),Object(n.useEffect)((function(){if(i){var e=i.map((function(e,t){var a=0,n=0;return e.units.forEach((function(e){a+=s(e),n+=e.powerLevel})),r.a.createElement(E.a,{className:"mb-3",key:t,onClick:function(){return y(e)},style:{border:"1px solid ".concat(e.traitColor||"rgb(0, 123, 255)")}},r.a.createElement(E.a.Body,null,r.a.createElement(E.a.Title,{as:"h2"},e.name),r.a.createElement(E.a.Text,null,n+" PL ",a+" CP")))}));N(e)}}),[i]),a?r.a.createElement(R,{crusadeArmy:a,handleDeleteArmy:function(){return A(a)},goBack:function(){return l(void 0)},saveArmy:O}):p?r.a.createElement(z.Provider,{value:p.traitColor||"blue"},r.a.createElement(D,{deleteArmy:A,crusadeArmy:p,goBack:function(){return y(void 0)},updateArmy:O})):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"my-2 mx-1 header"},r.a.createElement("h2",null,"Crusade Armies")),r.a.createElement(d.a,{className:"flex-grow-1",style:{overflow:"auto"}},r.a.createElement(f.a,null,C)),r.a.createElement(d.a,{md:"2"},r.a.createElement(f.a,{xs:4},r.a.createElement(h.a,{block:!0,size:"lg",variant:"primary",onClick:function(){var e,t={name:"",id:null!==(e=null===i||void 0===i?void 0:i.length)&&void 0!==e?e:0,units:[]};l(t)}},"Add"))))},W=a(279),z=r.a.createContext("blue");var M=function(){return r.a.createElement(W.a,{fluid:!0,className:"h-100"},r.a.createElement(X,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},40:function(e,t,a){e.exports=a.p+"static/media/DeleteIcon.0d10f8f1.svg"},98:function(e,t,a){e.exports=a.p+"static/media/EditIcon.aa0b5ae2.svg"},99:function(e,t,a){e.exports=a.p+"static/media/CopyIcon.49972eac.svg"}},[[101,1,2]]]);
//# sourceMappingURL=main.35616073.chunk.js.map